<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>Projects | Security Portfolio</title>
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet" />
    <link href="css/styles.css" rel="stylesheet" />
  </head>

  <body class="d-flex flex-column h-100 bg-light">
    <main class="flex-shrink-0">
      <!-- Navigation -->
      <nav class="navbar navbar-expand-lg navbar-light bg-white py-3">
        <div class="container px-5">
          <a class="navbar-brand fw-bolder text-primary" href="index.html">Ryusei | Security Portfolio</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0 fw-bolder">
              <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
              <li class="nav-item"><a class="nav-link active" href="projects.html">Projects</a></li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Header -->
      <header class="py-5">
        <div class="container px-5 mb-5">
          <div class="text-center">
            <h1 class="display-5 fw-bolder mb-0">
              <span class="text-gradient d-inline">プロジェクト</span>
            </h1>
            <p class="lead text-muted mt-3 mb-0">
              実攻撃ログをもとに、分析 → 可視化 → 検知（SPL）まで落とし込むことを重視しています。
            </p>
          </div>
        </div>
      </header>

      <!-- Content -->
      <section class="pb-5">
        <div class="container px-5">
          <div class="row gx-5 justify-content-center">
            <div class="col-12 col-xl-11 col-xxl-10">
              <!-- Featured Project -->
              <div class="card shadow border-0 rounded-4 mb-5">
                <div class="card-body p-5">
                  <div class="d-flex align-items-center mb-3">
                    <span class="badge bg-primary me-2">注目プロジェクト</span>
                    <h2 class="fw-bolder mb-0">Cowrie Honeypot × Splunk 攻撃ログ分析</h2>
                  </div>

                  <p class="text-muted mb-4">
                    GCP上のCowrieで収集したSSH/Telnet攻撃ログをSplunkに集約し、攻撃傾向の可視化と検知クエリ（SPL）を作成しました。
                    “攻撃の手法”だけでなく“目的”に注目し、再現性のある分析に落とし込みます。
                  </p>

                  <!-- データセット概要 -->
                  <div class="mb-4">
                    <h4 class="fw-bolder mb-2">データセット概要</h4>
                    <p class="text-muted mb-0">
                      2026年1月4日から1月6日までの約3日間、GCP上に構築した Cowrie Honeypot を稼働させ、
                      SSH に関する実攻撃ログを収集・分析しました。 その結果、約2,700件の攻撃イベントを観測しました。
                    </p>
                  </div>

                  <!-- Project Summary -->
                  <div class="row g-4">
                    <div class="col-md-6">
                      <div class="p-4 bg-light rounded-4 h-100">
                        <h5 class="fw-bolder">目的</h5>
                        <ul class="text-muted mb-0">
                          <li>実攻撃ログの収集と傾向分析（時間帯 / 攻撃元 / 試行内容）</li>
                          <li>検知に使えるSPLの作成（可視化・ランキング・異常検知）</li>
                          <li>成果物としてダッシュボード化</li>
                        </ul>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="p-4 bg-light rounded-4 h-100">
                        <h5 class="fw-bolder">構成</h5>
                        <ul class="text-muted mb-0">
                          <li>Honeypot：Cowrie（GCP）</li>
                          <li>転送：Universal Forwarder</li>
                          <li>分析：Splunk Enterprise（Dashboard / SPL）</li>
                        </ul>
                      </div>
                    </div>
                  </div>

                  <!-- 成果物 -->
                  <h4 class="fw-bolder mt-5 mb-3">成果物</h4>

                  <!-- 攻撃一覧 -->
                  <h4 class="fw-bolder mt-4 mb-3">攻撃一覧（SSH）</h4>
                  <p class="text-muted mb-4">
                    Cowrie Honeypot により観測された SSH に対する攻撃を、<code>attack_type</code> ごとに分類し件数を集計しました。
                    偵察（スキャン）や認証試行が多い一方で、侵入成功後の挙動（マルウェア取得・コマンド実行）も一部確認されています。
                  </p>

                  <div class="table-responsive">
                    <table class="table table-bordered align-middle w-100 mb-0">
                      <thead class="table-light">
                        <tr>
                          <th>攻撃種別（attack_type）</th>
                          <th>概要</th>
                          <th class="text-end">件数（total）</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>SSH接続スキャン</td>
                          <td>SSHポートへの接続可否を確認する偵察</td>
                          <td class="text-end">1,057</td>
                        </tr>
                        <tr>
                          <td>セッション終了</td>
                          <td>接続後すぐに切断されたセッション</td>
                          <td class="text-end">485</td>
                        </tr>
                        <tr>
                          <td>SSHブルートフォース（認証失敗）</td>
                          <td>ユーザ名・パスワードを大量に試行する攻撃</td>
                          <td class="text-end">417</td>
                        </tr>
                        <tr>
                          <td>SSH鍵交換（偵察）</td>
                          <td>鍵交換まで行いサーバ情報を確認する挙動</td>
                          <td class="text-end">282</td>
                        </tr>
                        <tr>
                          <td>その他</td>
                          <td>上記に分類できないイベント</td>
                          <td class="text-end">265</td>
                        </tr>
                        <tr>
                          <td>SSH侵入成功</td>
                          <td>認証成功によりセッションが確立</td>
                          <td class="text-end">209</td>
                        </tr>
                        <tr>
                          <td>マルウェアダウンロード</td>
                          <td>wget/curl等で外部からファイル取得を試行</td>
                          <td class="text-end">18</td>
                        </tr>
                        <tr>
                          <td>侵入後コマンド実行</td>
                          <td>侵入後にコマンド実行を試行</td>
                          <td class="text-end">12</td>
                        </tr>
                        <tr>
                          <td>不正ファイルアップロード</td>
                          <td>不正なファイル転送を試行</td>
                          <td class="text-end">1</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                  <p class="small text-muted mt-2 mb-0">
                    ※ Splunk上で <code>attack_type</code> ごとに集計した結果です（表示期間：2026/01/04〜2026/01/06）
                  <br> 上記の分析結果は、以下のSPLで eventid を攻撃種別に分類・集計した結果に基づきます。
                  </p>
                  <h4 class="fw-bolder mb-2">SPL</h4>
                  <pre class="bg-dark text-white p-3 rounded-4 mb-0"><code>index=* sourcetype="cowrie:json" 
| eval attack_type=case(
    eventid=="cowrie.login.failed","SSHブルートフォース（認証失敗）",
    eventid=="cowrie.login.success","SSH侵入成功",
    eventid=="cowrie.session.connect","SSH接続スキャン",
    eventid=="cowrie.client.kex","SSH鍵交換（偵察）",
    eventid=="cowrie.command.input","侵入後コマンド実行",
    eventid=="cowrie.session.file_download","マルウェアダウンロード",
    eventid=="cowrie.session.file_upload","不正ファイルアップロード",
    eventid=="cowrie.session.closed","セッション終了",
    true(),"その他"
)
| stats count as total by attack_type
| sort - total</code></pre>

                  <!-- スクショ -->
                  <div class="row g-4 mt-2">
                    <div class="col-md-6">
                      <div class="border rounded-4 bg-white p-3 h-100">
                        <p class="small text-muted mb-2">ダッシュボード（攻撃一覧 / 推移）</p>
                        <img
                          src="assets/attack_type.png"
                          class="img-fluid rounded-3"
                          alt="Splunk dashboard screenshot"
                        />
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="border rounded-4 bg-white p-3 h-100">
                        <p class="small text-muted mb-2">システム構成図</p>
                        <img
                          src="assets/project-architecture.png"
                          class="img-fluid rounded-3"
                          alt="architecture diagram"
                        />
                      </div>
                    </div>
                  </div>

                  <!-- Findings -->
                  <h4 class="fw-bolder mt-5 mb-3">主な分析結果</h4>
                  <ul class="text-muted">
                    <li>3日間で約2,700件のSSH関連の攻撃を観測し、そのうちSSH接続スキャンが1,057件（約40%）を占めました。まず偵察を行い、その後に認証試行（ブルートフォース）が続く傾向が見られました。（attck_type集計より）</li>
                    <li>認証成功に相当するイベントが209件観測され、さらに一部のセッションでは侵入後の操作（外部ファイル取得、コマンド実行、不正アップロード）が確認できました。</li>
                  </ul>

                  <!-- SPL -->
                  <h4 class="fw-bolder mt-5 mb-3">攻撃の深掘り</h4>
                  <div class="mb-4">
                    <p class="fw-bolder mb-2">1)国別攻撃元ランキング</p>
                     <img
                          src="assets/country.png"
                          class="img-fluid rounded-3"
                          alt="国別攻撃元ランキング"
                        />
                    <pre class="bg-dark text-white p-3 rounded-4 mb-0"><code></code>index=* cowrie
| iplocation src_ip
| stats count as attack_count by Country
| sort - attack_count
| head 5</pre>
                    <p class="small text-muted mt-2 mb-0">観測できた約2,700件がどこからされたのかを国別でTOP5を調べました。しかし、BOTや踏み台サーバにされている可能性もあるため、大本の攻撃者の国かどうかは今回は判断できておりません。</p>
                  </div>

                  <div class="mb-4">
                    <p class="fw-bolder mb-2">2) ブルートフォースで使われたユーザネームとパスワード</p>
                     <p class="small text-muted mt-2 mb-0">ユーザネームとパスワードは別々で試行回数のランキングを作りました。<br>まずは、ユーザネームからです。</p>
                      <img
                          src="assets/country.png"
                          class="img-fluid rounded-3"
                          alt="国別攻撃元ランキング"
                        />
                    <pre class="bg-dark text-white p-3 rounded-4 mb-0"><code>index=* sourcetype=cowrie:json
| stats count as events by src_ip
| sort - events
| head 20</code></pre>
                    <p class="small text-muted mt-2 mb-0">攻撃元IPの上位を抽出し、偏りや継続的な攻撃元を把握します。</p>
                  </div>

                  <div class="mb-4">
                    <p class="fw-bolder mb-2">3) 侵入後コマンド（観測できる場合）</p>
                    <pre class="bg-dark text-white p-3 rounded-4 mb-0"><code>index=* sourcetype=cowrie:json eventid="cowrie.command.input"
| stats count as hits by input
| sort - hits
| head 30</code></pre>
                    <p class="small text-muted mt-2 mb-0">侵入後に入力されたコマンドを集計し、目的（ダウンロード/展開/永続化）の推定に使います。</p>
                  </div>

                  <!-- Links -->
                  <h4 class="fw-bolder mt-5 mb-3">再現手順・関連リンク</h4>
                  <ul class="text-muted mb-0">
                    <li>
                      GitHub（手順・構成・SPLまとめ）：
                      <a href="https://github.com/ryusei-kitakawa" target="_blank" rel="noopener"
                        >https://github.com/ryusei-kitagawa</a
                      >
                    </li>
                    <li>データの扱い：攻撃元IP等は必要に応じてマスクして共有</li>
                    <li>今後：Suricata連携、GeoIPで国別傾向、アラート化（Saved Search）</li>
                  </ul>
                </div>
              </div>

              <!-- Next -->
              <div class="card shadow border-0 rounded-4">
                <div class="card-body p-5">
                  <h2 class="fw-bolder mb-3">今後の展開</h2>
                  <p class="text-muted mb-0">
                    次は、Splunk上で「攻撃一覧の自動分類」「アラート（閾値・急増検知）」「Suricataログとの相関分析」を追加予定です。
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="bg-white py-4 mt-auto">
      <div class="container px-5">
        <div class="row justify-content-between">
          <div class="col-auto text-muted small">© 2026 Ryusei Kitakawa</div>
          <div class="col-auto">
            <a href="https://github.com/ryusei-kitakawa" target="_blank" class="text-muted me-3" rel="noopener">
              <i class="bi bi-github"></i>
            </a>
          </div>
        </div>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
